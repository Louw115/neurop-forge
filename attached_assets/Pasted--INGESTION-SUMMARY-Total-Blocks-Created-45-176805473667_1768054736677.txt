
--------------------------------------------------
INGESTION SUMMARY:
  Total Blocks Created: 4582
  Total Quarantined: 80
  Total Errors: 526

STEP 3: Library Statistics
--------------------------------------------------
Total Blocks in Library: 4552
Categories: {'arithmetic': 829, 'string': 960, 'transformation': 333, 'validation': 842, 'collection': 786, 'filtering': 529, 'aggregation': 107, 'comparison': 44, 'sorting': 33, 'searching': 46, 'utility': 43}
Average Trust Score: 0.36

STEP 4: Sample Queries Across Domains
--------------------------------------------------

Query: 'string manipulation trim uppercase' (String Operations)
  Found: 5 blocks
    - is_valid_uuid_v4: Check if a string is a valid UUID v4....
    - equals: Check if booleans are equal....
    - is_string: Check if value is a string....

Query: 'list flatten unique sort' (Collection Operations)
  Found: 5 blocks
    - is_valid_uuid_v4: Check if a string is a valid UUID v4....
    - is_valid_longitude: Check if longitude is valid....
    - is_stale_within_tolerance: Check if cache is stale but within toler...

Query: 'validate email url phone' (Validation)
  Found: 5 blocks
    - is_valid_uuid_v4: Check if a string is a valid UUID v4....
    - is_valid_longitude: Check if longitude is valid....
    - validate_email_format: Validate email format....

Query: 'convert integer float string' (Type Conversion)
  Found: 5 blocks
    - is_valid_uuid_v4: Check if a string is a valid UUID v4....
    - equals: Check if booleans are equal....
    - is_string: Check if value is a string....

Query: 'compare equals greater less clamp' (Comparison Logic)
  Found: 5 blocks
    - compare_migration_ids: Compare two migration IDs. Returns -1, 0...
    - equals: Check if booleans are equal....
    - compare_slugs: Compare two slugs for equality (case-ins...

Query: 'date days between weekend leap year' (Date/Time)
  Found: 5 blocks
    - validate_email_format: Validate email format....
    - is_stale_within_tolerance: Check if cache is stale but within toler...
    - validate_slug: Validate slug format....

STEP 5: SEMANTIC COMPOSITION - The Key Innovation
--------------------------------------------------
Query: 'validate and format user input'

A) OLD APPROACH (Keyword Matching):
   Would match blocks containing 'validate', 'format', 'user', 'input'
   Problem: Returns irrelevant blocks like 'is_light_color' or 'format_bytes'

   Keyword-matched blocks: 10
     - validate_sort_param
     - is_valid_uuid_v4
     - is_valid_longitude

B) NEW APPROACH (Semantic Intent Matching):
   Matches by DOMAIN: validation -> formatting
   Matches by TYPE FLOW: input types -> output types
   Orders by OPERATION: validate first, then format

RESULT: Semantic Block Graph
--------------------------------------------------
Graph Valid: True
Composition Confidence: 100.00%
Total Trust Score: 0.38
Number of Nodes: 6

Intent Analysis:
  Required Domains: SemanticDomain.VALIDATION, SemanticDomain.FORMATTING
  Flow Direction: validate_then_format

Blocks in Semantic Graph (ordered by operation semantics):
  [0] is_valid_uuid_v4
      Domain: validation | Operation: check
      Why Selected: Matches domain: validation
  [1] is_valid_longitude
      Domain: validation | Operation: check
      Why Selected: Matches domain: validation
  [2] validate_email_format
      Domain: validation | Operation: validate
      Why Selected: Matches domain: validation
  [3] format_ttl_human_readable
      Domain: formatting | Operation: format
      Why Selected: Matches domain: formatting
  [4] format_duration_milliseconds
      Domain: formatting | Operation: format
      Why Selected: Matches domain: formatting
  [5] format_badge_count
      Domain: formatting | Operation: format
      Why Selected: Matches domain: formatting

STEP 5b: Semantic Index Statistics
--------------------------------------------------
Total Semantically Indexed: 4552 blocks

Blocks by Semantic Domain:
  string: 954 blocks
  validation: 842 blocks
  collection: 611 blocks
  filtering: 552 blocks
  calculation: 442 blocks
  transformation: 355 blocks
  io: 261 blocks
  utility: 150 blocks
  aggregation: 95 blocks
  comparison: 55 blocks

STEP 6: Library Breakdown by Category
--------------------------------------------------
  String: 50 blocks
  List: 50 blocks
  Validation: 50 blocks
  Conversion: 50 blocks
  Comparison: 50 blocks
  Logic: 50 blocks
  Date: 50 blocks
  Time: 50 blocks

======================================================================
LIBRARY INGESTION COMPLETE
======================================================================

SUMMARY:
  - 175 source modules ingested
  - 4582 blocks created
  - 0.36 average trust score

CAPABILITIES NOW AVAILABLE:
  - String manipulation (trim, split, join, replace, etc.)
  - Collection operations (flatten, unique, sort, chunk, etc.)
  - Data validation (email, URL, phone, patterns, etc.)
  - Type conversions (int, float, string, boolean, etc.)
  - Comparison logic (equals, between, clamp, coalesce, etc.)
  - Date/time utilities (days between, leap year, format, etc.)
  - Math & statistics (sqrt, median, variance, trig, etc.)
  - Path utilities (join path, get extension, is_image, etc.)
  - Data parsing (JSON, CSV, key-value, nested dict, etc.)
  - Encoding & hashing (MD5, SHA256, base64, URL encode, etc.)
  - URL utilities (parse URL, query strings, domains, etc.)
  - Text analysis (word count, reading time, lexical diversity)
  - Color utilities (hex to RGB, blend, brightness, etc.)
  - Formatting (currency, bytes, duration, ordinals, etc.)
  - Array operations (matrix multiply, transpose, vectors, etc.)
  - Security (sanitize, mask, detect injection, etc.)
  - HTTP utilities (status codes, MIME types, headers, cookies)
  - File type detection (extensions, magic bytes, categories)
  - Cryptography helpers (JWT, HMAC, base64, hashing patterns)
  - Data transformation (normalize, pivot, aggregate, window)
  - Regex utilities (pattern building, extraction, replacement)
  - UUID utilities (validation, parsing, version detection)
  - Geolocation (haversine distance, bearing, coordinates)
  - Caching utilities (TTL, keys, eviction, ETag, hit rate)
  - Rate limiting (token bucket, sliding window, backoff)
  - Email utilities (validation, parsing, masking, mailto)
  - Configuration (env parsing, feature flags, DSN parsing)
  - Pagination (offset/limit, cursor, page calculations)
  - Slug utilities (URL slugs, base62/36 IDs, checksum)
  - Money utilities (currency formatting, tax, interest)
  - Phone utilities (parsing, formatting, validation)
  - Markdown utilities (formatting, parsing, TOC generation)
  - SQL building (query construction, escaping, DDL)
  - SQL types (type mapping, validation, casting)
  - Query helpers (analysis, manipulation, pagination)
  - Migration helpers (schema changes, versioning)
  - Transaction helpers (isolation, locking, retries)
  - Data integrity (validation, constraints, checksums)
  - NoSQL helpers (MongoDB, Redis, DynamoDB patterns)
  - ORM patterns (model mapping, relationships, scopes)
  - Connection pool (sizing, health, metrics)
  - Batch operations (bulk insert, parallel processing)
  - Audit logging (change tracking, compliance)
  - API patterns (REST endpoints, versioning, HATEOAS)
  - Auth patterns (JWT, OAuth, sessions, API keys)
  - Webhook patterns (signatures, retries, delivery)
  - Request validation (fields, formats, constraints)
  - Response formatting (pagination, errors, JSONAPI)
  - Error handling (categorization, retry, circuit breaker)
  - Middleware patterns (logging, tracing, security)
  - Job scheduling (cron, queues, retries, workers)
  - State machines (transitions, sagas, workflows)
  - Event sourcing (events, snapshots, projections)
  - Queue patterns (routing, acknowledgments, DLQ)

STEP 7: RUNTIME EXECUTION - Complete the Loop
--------------------------------------------------

Executing the FULL pipeline:
  Intent -> Compose -> Execute -> Result

A) Direct Block Execution (Known-Good Blocks):
----------------------------------------
  Block 'is_empty': SUCCESS -> {'result': False}

Direct Execution: 1 blocks executed successfully

B) Block Verification (Verified-Only Mode):
----------------------------------------
Verifying 4552 blocks...
  Verified: 2740 blocks
  Failed: 1812 blocks
  Success Rate: 60.2%

Semantic Composer now using ONLY 2740 verified blocks

Tier Classification: 2060 Tier-A, 680 Tier-B

Production Mode: Using ONLY 2060 Tier-A blocks (deterministic)

Verification Gate Stats: 2740 admitted, 1812 rejected

C) Semantic Graph Execution (Tier-A Only - Production Mode):
----------------------------------------
Test Inputs: {'text': 'Hello World', 's': 'Hello World', 'string': 'Hello World', 'value': 'Hello World', 'n': 42, 'number': 42}

Execution Result:
  Status: PARTIAL_SUCCESS
  Duration: 1212.02ms
  Nodes Executed: 9
  Nodes Succeeded: 5

Execution Trace:
  ✓ is_valid_uuid_v4 (1.00ms)
  ✗ is_valid_longitude (301.60ms)
      Error: TypeError: '<=' not supported between instances of...
  ✓ is_compressible (1.02ms)
  ✓ to_camel_case (0.99ms)
  ✗ convert_currency (301.79ms)
      Error: TypeError: can't multiply sequence by non-int of t...
  ✗ add_context_to_entry (302.19ms)
      Error: ValueError: dictionary update sequence element #0 ...



D) Golden Validation Suite - Known-Working Blocks:
----------------------------------------
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "C:\Users\Lourens\Desktop\NeuropForge\neurop_forge\main.py", line 1104, in <module>
    run_production_validation()
  File "C:\Users\Lourens\Desktop\NeuropForge\neurop_forge\main.py", line 1044, in run_production_validation
    golden_results = run_golden_validation(forge._block_store)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lourens\Desktop\NeuropForge\neurop_forge\runtime\golden_validation.py", line 214, in run_golden_validation
    results = runner.run_golden_validation()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lourens\Desktop\NeuropForge\neurop_forge\runtime\golden_validation.py", line 104, in run_golden_validation
    self.discover_golden_blocks()
  File "C:\Users\Lourens\Desktop\NeuropForge\neurop_forge\runtime\golden_validation.py", line 67, in discover_golden_blocks
    elif self._matches_expected_type(block, golden):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lourens\Desktop\NeuropForge\neurop_forge\runtime\golden_validation.py", line 76, in _matches_expected_type
    out_type = block.interface.outputs[0].type
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'TypedParameter' object has no attribute 'type'

C:\Users\Lourens\Desktop\NeuropForge>